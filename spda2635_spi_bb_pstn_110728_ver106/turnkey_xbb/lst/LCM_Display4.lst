C51 COMPILER V9.00   LCM_DISPLAY4                                                          07/09/2012 21:16:49 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE LCM_DISPLAY4
OBJECT MODULE PLACED IN .\obj\LCM_Display4.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE LCM\LCM_Display4.c LARGE OPTIMIZE(9,SIZE) BROWSE NOAREGS INCDIR(..\libsourc
                    -e\header) DEFINE(K_ICTYPE=0x03) DEBUG OBJECTEXTEND PRINT(.\lst\LCM_Display4.lst) OBJECT(.\obj\LCM_Display4.obj)

line level    source

   1          #include "..\Header\SPDA2K.h"
   2          #include "..\header\UI_config.h"
   3          #include "..\header\variables.h"
   4          #include "..\LCM\LCM_BMP.h"
   5          
   6          void LCM_ShowYear(U8 tc_Year)
   7          {
   8   1              gc_LCM_line=3;
   9   1              tc_Year+=10;
  10   1              LCM_ShowChar8x16(2,24); // "2"
  11   1              LCM_ShowChar8x16(0,32); // "0"
  12   1              LCM_ShowChar8x16(tc_Year/10,40);
  13   1              LCM_ShowChar8x16(tc_Year%10,48);
  14   1      }
  15          
  16          
  17          void LCM_ShowMonth(U8 tc_Month)
  18          {
  19   1              gc_LCM_line=3;
  20   1              LCM_ShowChar8x16(tc_Month/10,64);
  21   1              LCM_ShowChar8x16(tc_Month%10,72);
  22   1      }
  23          
  24          
  25          void LCM_ShowDay(U8 tc_Day)
  26          {
  27   1              gc_LCM_line=3;
  28   1              LCM_ShowChar8x16(tc_Day/10,88);
  29   1              LCM_ShowChar8x16(tc_Day%10,96);
  30   1      }
  31          
  32          
  33          void LCM_ShowHour(U8 tc_Hour)
  34          {
  35   1              gc_LCM_line=5;
  36   1              LCM_ShowChar8x16(tc_Hour/10,32);
  37   1              LCM_ShowChar8x16(tc_Hour%10,40);
  38   1      }
  39          
  40          
  41          void LCM_ShowMin(U8 tc_Min)
  42          {
  43   1              gc_LCM_line=5;
  44   1              LCM_ShowChar8x16(tc_Min/10,56);
  45   1              LCM_ShowChar8x16(tc_Min%10,64);
  46   1      }
  47          
  48          
  49          void LCM_ShowSec(U8 tc_Sec)
  50          {
  51   1              gc_LCM_line=5;
  52   1              LCM_ShowChar8x16(tc_Sec/10,80);
  53   1              LCM_ShowChar8x16(tc_Sec%10,88);
  54   1      }
C51 COMPILER V9.00   LCM_DISPLAY4                                                          07/09/2012 21:16:49 PAGE 2   

  55          
  56          void LCM_ShowSetupMenu(U8 tc_item)
  57          {
  58   1              data    U8      i;
  59   1              xdata   U8      *p;
  60   1      
  61   1              switch(tc_item)
  62   1              {
  63   2                      case 0: // ¨t²Î®É¶¡
  64   2                              p=gc_Str_Clock[gc_CurrentHZK];
  65   2                      break;
  66   2      
  67   2                      case 1: // ­I¥ú®É¶¡
  68   2                              p=gc_Str_Backlight[gc_CurrentHZK];
  69   2                      break;
  70   2      
  71   2                      case 2: // »y¨¥
  72   2                              p=gc_Str_Language[gc_CurrentHZK];
  73   2                      break;
  74   2      
  75   2                      case 3: // ¾xÄÁ
  76   2                              p=gc_Str_AlarmClock[gc_CurrentHZK];
  77   2                      break;
  78   2      
  79   2                      case 4: // °h¥X
  80   2                              p=gc_Str_Exit[gc_CurrentHZK];
  81   2                      break;
  82   2              }
  83   1      
  84   1              if(tc_item==gc_SetupMenuNum)
  85   1              {
  86   2                      gb_LCM_InverseDisp=1;
  87   2              }
  88   1      
  89   1              for(i=0;i<p[0];i++)
  90   1              {
  91   2                      gc_LrcDisplayBuf[i]=p[1+i];
  92   2              }
  93   1              LCM_DisplayMenuString(&gc_LrcDisplayBuf,p[0],0,(tc_item%4)*16,1);
  94   1              gb_LCM_InverseDisp=0;
  95   1      }
  96          
  97          void LCM_ShowTitle_SetClock(void)
  98          {
  99   1              data    U8      i;
 100   1              xdata   U8      *p;
 101   1      
 102   1              p=gc_Str_Clock[gc_CurrentHZK];
 103   1              for(i=0;i<p[0];i++)
 104   1              {
 105   2                      gc_LrcDisplayBuf[i]=p[1+i];
 106   2              }
 107   1              LCM_DisplayMenuString(&gc_LrcDisplayBuf,p[0],32,0,1);
 108   1      }
 109          
 110          #ifdef SPI_1M
 111          /////////////////////2M spi 2 language
 112          void LCM_ShowCalendarFrame(void)
 113          {
 114   1              LCM_Clear_L0_L7();
 115   1              if(gc_CurrentHZK==LANG_CHS)
 116   1              {
C51 COMPILER V9.00   LCM_DISPLAY4                                                          07/09/2012 21:16:49 PAGE 3   

 117   2                      gc_LrcDisplayBuf[0]=0xC4;       // ¦~
 118   2                      gc_LrcDisplayBuf[1]=0xEA;
 119   2                      LCM_DisplayMenuString(&gc_LrcDisplayBuf,2,32,0,0);
 120   2                      LCM_DisplayMenuString(&gc_LrcDisplayBuf,2,32,48,0);
 121   2                      gc_LrcDisplayBuf[0]=0xD4;       // ¤ë
 122   2                      gc_LrcDisplayBuf[1]=0xC2;
 123   2                      LCM_DisplayMenuString(&gc_LrcDisplayBuf,2,64,0,0);
 124   2                      LCM_DisplayMenuString(&gc_LrcDisplayBuf,2,64,48,0);     
 125   2                      gc_LrcDisplayBuf[0]=0xC8;       // ¤é
 126   2                      gc_LrcDisplayBuf[1]=0xD5;
 127   2                      LCM_DisplayMenuString(&gc_LrcDisplayBuf,2,96,0,0);
 128   2                      gc_LrcDisplayBuf[0]=0xD0;       // ¬P´Á
 129   2                      gc_LrcDisplayBuf[1]=0xC7;
 130   2                      gc_LrcDisplayBuf[2]=0xC6;
 131   2                      gc_LrcDisplayBuf[3]=0xDA;
 132   2                      LCM_DisplayMenuString(&gc_LrcDisplayBuf,4,80,24,0);
 133   2                      gc_LCM_line=3;
 134   2                      gb_LCM_InverseDisp=1;
 135   2                      LCM_ShowChar10x16(10,22);       // :
 136   2                      LCM_ShowChar10x16(10,48);       // :
 137   2                      gb_LCM_InverseDisp=0;
 138   2              }
 139   1              else
 140   1              {
 141   2                      gc_LCM_line=3;
 142   2                      gb_LCM_InverseDisp=1;
 143   2                      LCM_ShowChar10x16(10,46);       // :
 144   2                      LCM_ShowChar10x16(10,72);       // :
 145   2                      gc_LCM_line=0;
 146   2                      gb_LCM_InverseDisp=0;
 147   2                      LCM_ShowChar8x16(11,56);        // -
 148   2                      LCM_ShowChar8x16(11,80);        // -
 149   2              }
 150   1              LCM_ShowCalendarWeek();
 151   1              LCM_ShowCalendarYear();
 152   1              LCM_ShowCalendarMonth();
 153   1              LCM_ShowCalendarDay();
 154   1              LCM_ShowCalendarHour();
 155   1              LCM_ShowCalendarMinute();
 156   1              LCM_ShowCalendarSecond();
 157   1              if(gc_CurrentHZK==LANG_CHS)
 158   1              {
 159   2                      Get_Lunar(gc_Year+1910,gc_Month,gc_Day);
 160   2                      LCM_ShowLunar();
 161   2              }
 162   1      }
 163          
 164          
 165          void LCM_ShowCalendarYear(void)
 166          {
 167   1              data    U8      tc_Offset=0;
 168   1              xdata   U8      tc_Year;
 169   1      
 170   1              tc_Year=gc_Year+10;
 171   1              if(gc_CurrentHZK!=LANG_CHS)
 172   1              {
 173   2                      tc_Offset=24;
 174   2              }
 175   1              gc_LCM_line=0;
 176   1              gb_LCM_InverseDisp=0;
 177   1              if(tc_Year<100)
 178   1              {
C51 COMPILER V9.00   LCM_DISPLAY4                                                          07/09/2012 21:16:49 PAGE 4   

 179   2                      LCM_ShowChar8x16(1,tc_Offset);  // 1
 180   2                      LCM_ShowChar8x16(9,8+tc_Offset);// 9
 181   2              }
 182   1              else
 183   1              {
 184   2                      tc_Year-=100;
 185   2                      LCM_ShowChar8x16(2,tc_Offset);  // 2
 186   2                      LCM_ShowChar8x16(0,8+tc_Offset);// 0
 187   2              }
 188   1              LCM_ShowChar8x16(tc_Year/10,16+tc_Offset);
 189   1              LCM_ShowChar8x16(tc_Year%10,24+tc_Offset);
 190   1      }
 191          
 192          
 193          void LCM_ShowCalendarMonth(void)
 194          {
 195   1              data U8 tc_Offset=0;
 196   1      
 197   1              if(gc_CurrentHZK!=LANG_CHS)
 198   1              {
 199   2                      tc_Offset=16;
 200   2              }
 201   1              gc_LCM_line=0;
 202   1              gb_LCM_InverseDisp=0;
 203   1              LCM_ShowChar8x16(gc_Month/10,48+tc_Offset);
 204   1              LCM_ShowChar8x16(gc_Month%10,56+tc_Offset);
 205   1      }
 206          
 207          
 208          void LCM_ShowCalendarDay(void)
 209          {
 210   1              data U8 tc_Offset=0;
 211   1      
 212   1              if(gc_CurrentHZK!=LANG_CHS)
 213   1              {
 214   2                      tc_Offset=8;
 215   2              }
 216   1              gc_LCM_line=0;
 217   1              gb_LCM_InverseDisp=0;
 218   1              LCM_ShowChar8x16(gc_Day/10,80+tc_Offset);
 219   1              LCM_ShowChar8x16(gc_Day%10,88+tc_Offset);
 220   1      }
 221          
 222          
 223          void LCM_ShowCalendarHour(void)
 224          {
 225   1              data U8 tc_Offset=0;
 226   1      
 227   1              if(gc_CurrentHZK!=LANG_CHS)
 228   1              {
 229   2                      tc_Offset=24;
 230   2              }
 231   1              gc_LCM_line=3;
 232   1              gb_LCM_InverseDisp=1;
 233   1              LCM_ShowChar10x16(gc_Hour/10,4+tc_Offset);
 234   1              LCM_ShowChar10x16(gc_Hour%10,14+tc_Offset);
 235   1      }
 236          
 237          void LCM_ShowCalendarMinute(void)
 238          {
 239   1              data U8 tc_Offset=0;
 240   1      
C51 COMPILER V9.00   LCM_DISPLAY4                                                          07/09/2012 21:16:49 PAGE 5   

 241   1              if(gc_CurrentHZK!=LANG_CHS)
 242   1              {
 243   2                      tc_Offset=24;
 244   2              }
 245   1              gc_LCM_line=3;
 246   1              gb_LCM_InverseDisp=1;
 247   1              LCM_ShowChar10x16(gc_Min/10,30+tc_Offset);
 248   1              LCM_ShowChar10x16(gc_Min%10,40+tc_Offset);
 249   1      }
 250          
 251          void LCM_ShowCalendarSecond(void)
 252          {
 253   1              data U8 tc_Offset=0;
 254   1      
 255   1              if(gc_CurrentHZK!=LANG_CHS)
 256   1              {
 257   2                      tc_Offset=24;
 258   2              }
 259   1              gc_LCM_line=3;
 260   1              gb_LCM_InverseDisp=1;
 261   1              LCM_ShowChar10x16(gc_Sec/10,56+tc_Offset);
 262   1              LCM_ShowChar10x16(gc_Sec%10,66+tc_Offset);
 263   1      }
 264          
 265          void LCM_ShowCalendarWeek(void)
 266          {
 267   1              data    U8      i;
 268   1              xdata   U8      tc_w;
 269   1              xdata   U8      *p;
 270   1      
 271   1              switch(gc_Week)
 272   1              {
 273   2                      case 0: // Monday
 274   2                              p=gc_Str_Monday[gc_CurrentHZK];
 275   2                      break;
 276   2      
 277   2                      case 1: // Tuesday
 278   2                              p=gc_Str_Tuesday[gc_CurrentHZK];
 279   2                      break;
 280   2      
 281   2                      case 2: // Wednesday
 282   2                              p=gc_Str_Wednesday[gc_CurrentHZK];
 283   2                      break;
 284   2      
 285   2                      case 3: // Thursday
 286   2                              p=gc_Str_Thursday[gc_CurrentHZK];
 287   2                      break;
 288   2      
 289   2                      case 4: // Friday
 290   2                              p=gc_Str_Friday[gc_CurrentHZK];
 291   2                      break;
 292   2      
 293   2                      case 5: // Saturday
 294   2                              p=gc_Str_Saturday[gc_CurrentHZK];
 295   2                      break;
 296   2      
 297   2                      case 6: // Sunday
 298   2                              p=gc_Str_Sunday[gc_CurrentHZK];
 299   2                      break;
 300   2              }
 301   1      
 302   1              for(i=0;i<p[0];i++)
C51 COMPILER V9.00   LCM_DISPLAY4                                                          07/09/2012 21:16:49 PAGE 6   

 303   1              {
 304   2                      gc_LrcDisplayBuf[i]=p[1+i];
 305   2              }
 306   1      
 307   1              if(gc_CurrentHZK==LANG_CHS)
 308   1              {
 309   2                      LCM_DisplayMenuString(&gc_LrcDisplayBuf,p[0],112,24,0);
 310   2              }
 311   1              else
 312   1              {
 313   2                      LCM_Clear_L6_L7();      
 314   2                      tc_w=4;    
 315   2                      LCM_DisplayMenuString(&gc_LrcDisplayBuf,p[0],(128-tc_w*p[0])/2,48,0);
 316   2              }
 317   1      }
 318          
 319          
 320          void LCM_ShowLunar(void)
 321          {
 322   1              xdata   U8      tc_temp;
 323   1              // ¥Ò¤A¤þ¤B¥³¤v©°¨¯¤Ð¬Ñ
 324   1              code U8 K_Str_DiZhi[]={0xBC,0xD7,0xD2,0xD2,0xB1,0xFB,0xB6,0xA1,0xCE,0xEC,0xBC,0xBA,0xB8,0xFD,0xD0,0xC1,0x
             -C8,0xC9,0xB9,0xEF};   
 325   1              // ¤l¤¡±G¥f¨°¤x¤È¥¼¥Ó¨»¦¦¥è
 326   1              code U8 K_Str_Tiangan[]={0xD7,0xD3,0xB3,0xF3,0xD2,0xFA,0xC3,0xAE,0xB3,0xBD,0xCB,0xC8,0xCE,0xE7,0xCE,0xB4,
             -0xC9,0xEA,0xD3,0xCF,0xD0,0xE7,0xBA,0xA5};     
 327   1              // ¥¿¤G¤T¥|¤­¤»¤C¤K¤E¤Q¥VÃ¾
 328   1              code U8 K_Str_LunarMonth[]={0xD5,0xFD,0xB6,0xFE,0xC8,0xFD,0xCB,0xC4,0xCE,0xE5,0xC1,0xF9,0xC6,0xDF,0xB0,0x
             -CB,0xBE,0xC5,0xCA,0xAE,0xB6,0xAC,0xC0,0xB0};
 329   1      
 330   1              // Display Lunar Year
 331   1              gb_LCM_InverseDisp=0;
 332   1              gc_LrcDisplayBuf[0]=K_Str_DiZhi[gc_Dizhi*2+0];
 333   1              gc_LrcDisplayBuf[1]=K_Str_DiZhi[gc_Dizhi*2+1];
 334   1              gc_LrcDisplayBuf[2]=K_Str_Tiangan[gc_Tiangan*2+0];
 335   1              gc_LrcDisplayBuf[3]=K_Str_Tiangan[gc_Tiangan*2+1];
 336   1              LCM_DisplayMenuString(&gc_LrcDisplayBuf,4,0,48,0);
 337   1              // Display Lunar Month
 338   1              gc_LrcDisplayBuf[0]=K_Str_LunarMonth[gc_Month_Lunar*2-2];
 339   1              gc_LrcDisplayBuf[1]=K_Str_LunarMonth[gc_Month_Lunar*2-1]; 
 340   1              LCM_DisplayMenuString(&gc_LrcDisplayBuf,2,48,48,0);
 341   1              // Display Lunar Day
 342   1              if(gc_Day_Lunar%10==0)
 343   1              {
 344   2                      if(gc_Day_Lunar/10==1)
 345   2                      {
 346   3                              gc_LrcDisplayBuf[0]=0xb3;       // ªì
 347   3                              gc_LrcDisplayBuf[1]=0xf5;
 348   3                      }
 349   2                      else if(gc_Day_Lunar/10==2)
 350   2                      {
 351   3                              gc_LrcDisplayBuf[0]=0xb6;       // ¤G
 352   3                              gc_LrcDisplayBuf[1]=0xfe;
 353   3                      }
 354   2                      else
 355   2                      {
 356   3                              gc_LrcDisplayBuf[0]=0xc8;       // ¤T
 357   3                              gc_LrcDisplayBuf[1]=0xfd;                       
 358   3                      }
 359   2                      gc_LrcDisplayBuf[2]=0xca;       // ¤Q
 360   2                      gc_LrcDisplayBuf[3]=0xae;                       
 361   2              }
C51 COMPILER V9.00   LCM_DISPLAY4                                                          07/09/2012 21:16:49 PAGE 7   

 362   1              else
 363   1              {
 364   2                      if(gc_Day_Lunar/10==0)
 365   2                      {
 366   3                              gc_LrcDisplayBuf[0]=0xb3;       // ªì
 367   3                              gc_LrcDisplayBuf[1]=0xf5;
 368   3                      }
 369   2                      else if(gc_Day_Lunar/10==1)
 370   2                      {
 371   3                              gc_LrcDisplayBuf[0]=0xca;       // ¤Q
 372   3                              gc_LrcDisplayBuf[1]=0xae;                       
 373   3                      }
 374   2                      else
 375   2                      {
 376   3                              gc_LrcDisplayBuf[0]=0xbb;       // ¤Ü
 377   3                              gc_LrcDisplayBuf[1]=0xca;                       
 378   3                      }
 379   2      
 380   2                      tc_temp=gc_Day_Lunar%10;
 381   2                      if(tc_temp==1)
 382   2                      {
 383   3                              gc_LrcDisplayBuf[2]=0xd2;       // ¤@
 384   3                              gc_LrcDisplayBuf[3]=0xbb;
 385   3                      }
 386   2                      else
 387   2                      {
 388   3                              gc_LrcDisplayBuf[2]=K_Str_LunarMonth[tc_temp*2-2];
 389   3                              gc_LrcDisplayBuf[3]=K_Str_LunarMonth[tc_temp*2-1];
 390   3                      }
 391   2              }
 392   1              LCM_DisplayMenuString(&gc_LrcDisplayBuf,4,80,48,0);
 393   1              // Display Leap-month
 394   1              if(gb_LeapMonth==1)
 395   1              {
 396   2                      gb_LCM_InverseDisp=1;
 397   2                      gc_LrcDisplayBuf[0]=0xc8;       // Èò
 398   2                      gc_LrcDisplayBuf[1]=0xf2;
 399   2                      LCM_DisplayMenuString(&gc_LrcDisplayBuf,2,112,48,0);
 400   2              }
 401   1              else
 402   1              {
 403   2                      gc_LrcDisplayBuf[0]=0x20;
 404   2                      gc_LrcDisplayBuf[1]=0x00;
 405   2                      gc_LrcDisplayBuf[2]=0x20;
 406   2                      gc_LrcDisplayBuf[3]=0x00;
 407   2                      LCM_DisplayMenuString(&gc_LrcDisplayBuf,4,112,48,0);
 408   2              }
 409   1      }
 410          
 411          void LCM_ShowAlarmClockString(void)
 412          {
 413   1              data    U8      i;
 414   1              xdata   U8      *p;
 415   1      
 416   1              p=gc_Str_AlarmClock[gc_CurrentHZK];
 417   1              for(i=0;i<p[0];i++)
 418   1              {
 419   2                      gc_LrcDisplayBuf[i]=p[1+i];
 420   2              }
 421   1      
 422   1              LCM_DisplayMenuString(&gc_LrcDisplayBuf,p[0],0,0,0);
 423   1      }
C51 COMPILER V9.00   LCM_DISPLAY4                                                          07/09/2012 21:16:49 PAGE 8   

 424          
 425          void LCM_ShowTimeString(void)
 426          {
 427   1              data    U8      i;
 428   1              xdata   U8      *p;
 429   1      
 430   1              p=gc_Str_Time[gc_CurrentHZK];
 431   1              for(i=0;i<p[0];i++)
 432   1              {
 433   2                      gc_LrcDisplayBuf[i]=p[1+i];
 434   2              }
 435   1      
 436   1              LCM_DisplayMenuString(&gc_LrcDisplayBuf,p[0],0,16,0);
 437   1      }
 438          
 439          void LCM_ShowRepeatString(void)
 440          {
 441   1              data    U8      i;
 442   1              xdata   U8      *p;
 443   1      
 444   1              p=gc_Str_AlarmRepeat[gc_CurrentHZK];
 445   1              for(i=0;i<p[0];i++)
 446   1              {
 447   2                      gc_LrcDisplayBuf[i]=p[1+i];
 448   2              }
 449   1      
 450   1              LCM_DisplayMenuString(&gc_LrcDisplayBuf,p[0],0,32,0);
 451   1      }
 452          
 453          void LCM_ShowDaysString(U8 tc_Day)
 454          {
 455   1              data    U8      i;
 456   1              data    U8      x;
 457   1              xdata   U8      *p;
 458   1      
 459   1              switch(tc_Day)
 460   1              {
 461   2                      case 0: // Monday
 462   2                              p=gc_Str_Monday[gc_CurrentHZK];
 463   2                      break;
 464   2      
 465   2                      case 1: // Tuesday
 466   2                              p=gc_Str_Tuesday[gc_CurrentHZK];
 467   2                      break;
 468   2      
 469   2                      case 2: // Wednesday
 470   2                              p=gc_Str_Wednesday[gc_CurrentHZK];
 471   2                      break;
 472   2      
 473   2                      case 3: // Thursday
 474   2                              p=gc_Str_Thursday[gc_CurrentHZK];
 475   2                      break;
 476   2      
 477   2                      case 4: // Friday
 478   2                              p=gc_Str_Friday[gc_CurrentHZK];
 479   2                      break;
 480   2      
 481   2                      case 5: // Saturday
 482   2                              p=gc_Str_Saturday[gc_CurrentHZK];
 483   2                      break;
 484   2      
 485   2                      case 6: // Sunday
C51 COMPILER V9.00   LCM_DISPLAY4                                                          07/09/2012 21:16:49 PAGE 9   

 486   2                              p=gc_Str_Sunday[gc_CurrentHZK];
 487   2                      break;
 488   2      
 489   2                      case 7: // Exit
 490   2                              p=gc_Str_Exit[gc_CurrentHZK];
 491   2                              LCM_Clear_L6_L7();
 492   2                      break;
 493   2              }
 494   1              if((gc_CurrentHZK==LANG_CHS)&&tc_Day!=7)
 495   1              {
 496   2                      gc_LrcDisplayBuf[0]=0xD0;       // ¬P´Á
 497   2                      gc_LrcDisplayBuf[1]=0xc7;
 498   2                      gc_LrcDisplayBuf[2]=0xc6;
 499   2                      gc_LrcDisplayBuf[3]=0xda;
 500   2                      gc_LrcDisplayBuf[4]=p[1];
 501   2                      gc_LrcDisplayBuf[5]=p[2];
 502   2                      x=4;
 503   2              }
 504   1              else
 505   1              {
 506   2                      x=0;
 507   2                      for(i=0;i<p[0];i++)
 508   2                      {
 509   3                              gc_LrcDisplayBuf[i]=p[1+i];
 510   3                      }
 511   2              }
 512   1      
 513   1              gb_LCM_InverseDisp=0;
 514   1              if(tc_Day==gc_AlarmRepeat_DaySelect)
 515   1              {
 516   2                      gb_LCM_InverseDisp=1;
 517   2              }
 518   1              LCM_DisplayMenuString(&gc_LrcDisplayBuf,p[0]+x,16,(tc_Day%4)*16,1);
 519   1      }
 520          
 521          void LCM_ShowDaysSelect(void)
 522          {
 523   1              data    U8      i;
 524   1              data    U8      k;
 525   1              data    U8      tc_DaySelect;
 526   1              data    U8      tc_Count;
 527   1              xdata   U8      j;
 528   1              xdata   U16     tw_Addr;
 529   1      
 530   1              gb_LCM_InverseDisp=0;
 531   1              tc_DaySelect=gc_AlarmDaysSelect;
 532   1              if(gc_AlarmRepeat_DaySelect<4)
 533   1              {
 534   2                      tc_Count=4;
 535   2              }
 536   1              else
 537   1              {
 538   2                      tc_Count=3;
 539   2                      tc_DaySelect=tc_DaySelect>>4;
 540   2              }
 541   1      
 542   1              for(k=0;k<tc_Count;k++)
 543   1              {
 544   2                      tw_Addr=Select16x16;
 545   2                      if(tc_DaySelect&0x01)
 546   2                      {
 547   3                              tw_Addr+=32;
C51 COMPILER V9.00   LCM_DISPLAY4                                                          07/09/2012 21:16:49 PAGE 10  

 548   3                      }
 549   2                      tc_DaySelect=tc_DaySelect>>1;
 550   2                      LCM_ReadSPIBMPdata(tw_Addr,32);
 551   2                      for(i=0;i<2;i++)
 552   2                      {
 553   3                              LCM_set_address(i+k*2,0);
 554   3                              for(j=0;j<16;j++)
 555   3                              {
 556   4                                      LCM_write_data(gc_DirLCMtempBuf[i*16+j]);
 557   4                              }
 558   3                      }
 559   2              }
 560   1      }
 561                    
 562          
 563          #else
              /////////////////////////////////////////////
              ////////////////////////////////////////////
              ///////////////4M spi 17 lang
              void LCM_ShowCalendarFrame(void)
              {
                      LCM_Clear_L0_L7();
                      if(gc_CurrentHZK==LANG_CHS||gc_CurrentHZK==LANG_CHT)
                      {
                              gc_LrcDisplayBuf[0]=0x74;       // ¦~
                              gc_LrcDisplayBuf[1]=0x5E;
                              LCM_DisplayMenuString(&gc_LrcDisplayBuf,2,32,0,0);
                              LCM_DisplayMenuString(&gc_LrcDisplayBuf,2,32,48,0);
                              gc_LrcDisplayBuf[0]=0x08;       // ¤ë
                              gc_LrcDisplayBuf[1]=0x67;
                              LCM_DisplayMenuString(&gc_LrcDisplayBuf,2,64,0,0);
                              LCM_DisplayMenuString(&gc_LrcDisplayBuf,2,64,48,0);     
                              gc_LrcDisplayBuf[0]=0xE5;       // ¤é
                              gc_LrcDisplayBuf[1]=0x65;
                              LCM_DisplayMenuString(&gc_LrcDisplayBuf,2,96,0,0);
                              gc_LrcDisplayBuf[0]=0x1F;       // ¬P´Á
                              gc_LrcDisplayBuf[1]=0x66;
                              gc_LrcDisplayBuf[2]=0x1F;
                              gc_LrcDisplayBuf[3]=0x67;
                              LCM_DisplayMenuString(&gc_LrcDisplayBuf,4,80,24,0);
                              gc_LCM_line=3;
                              gb_LCM_InverseDisp=1;
                              LCM_ShowChar10x16(10,22);       // :
                              LCM_ShowChar10x16(10,48);       // :
                              gb_LCM_InverseDisp=0;
                      }
                      else
                      {
                              gc_LCM_line=3;
                              gb_LCM_InverseDisp=1;
                              LCM_ShowChar10x16(10,46);       // :
                              LCM_ShowChar10x16(10,72);       // :
                              gc_LCM_line=0;
                              gb_LCM_InverseDisp=0;
                              LCM_ShowChar8x16(11,56);        // -
                              LCM_ShowChar8x16(11,80);        // -
                      }
                      LCM_ShowCalendarWeek();
                      LCM_ShowCalendarYear();
                      LCM_ShowCalendarMonth();
                      LCM_ShowCalendarDay();
                      LCM_ShowCalendarHour();
C51 COMPILER V9.00   LCM_DISPLAY4                                                          07/09/2012 21:16:49 PAGE 11  

                      LCM_ShowCalendarMinute();
                      LCM_ShowCalendarSecond();
                      if(gc_CurrentHZK==LANG_CHS||gc_CurrentHZK==LANG_CHT)
                      {
                              Get_Lunar(gc_Year+1910,gc_Month,gc_Day);
                              LCM_ShowLunar();
                      }
              }
              
              
              void LCM_ShowCalendarYear(void)
              {
                      data    U8      tc_Offset=0;
                      xdata   U8      tc_Year;
              
                      tc_Year=gc_Year+10;
                      if(gc_CurrentHZK!=LANG_CHS&&gc_CurrentHZK!=LANG_CHT)
                      {
                              tc_Offset=24;
                      }
                      gc_LCM_line=0;
                      gb_LCM_InverseDisp=0;
                      if(tc_Year<100)
                      {
                              LCM_ShowChar8x16(1,tc_Offset);  // 1
                              LCM_ShowChar8x16(9,8+tc_Offset);// 9
                      }
                      else
                      {
                              tc_Year-=100;
                              LCM_ShowChar8x16(2,tc_Offset);  // 2
                              LCM_ShowChar8x16(0,8+tc_Offset);// 0
                      }
                      LCM_ShowChar8x16(tc_Year/10,16+tc_Offset);
                      LCM_ShowChar8x16(tc_Year%10,24+tc_Offset);
              }
              
              
              void LCM_ShowCalendarMonth(void)
              {
                      data U8 tc_Offset=0;
              
                      if(gc_CurrentHZK!=LANG_CHS&&gc_CurrentHZK!=LANG_CHT)
                      {
                              tc_Offset=16;
                      }
                      gc_LCM_line=0;
                      gb_LCM_InverseDisp=0;
                      LCM_ShowChar8x16(gc_Month/10,48+tc_Offset);
                      LCM_ShowChar8x16(gc_Month%10,56+tc_Offset);
              }
              
              
              void LCM_ShowCalendarDay(void)
              {
                      data U8 tc_Offset=0;
              
                      if(gc_CurrentHZK!=LANG_CHS&&gc_CurrentHZK!=LANG_CHT)
                      {
                              tc_Offset=8;
                      }
                      gc_LCM_line=0;
C51 COMPILER V9.00   LCM_DISPLAY4                                                          07/09/2012 21:16:49 PAGE 12  

                      gb_LCM_InverseDisp=0;
                      LCM_ShowChar8x16(gc_Day/10,80+tc_Offset);
                      LCM_ShowChar8x16(gc_Day%10,88+tc_Offset);
              }
              
              
              void LCM_ShowCalendarHour(void)
              {
                      data U8 tc_Offset=0;
              
                      if(gc_CurrentHZK!=LANG_CHS&&gc_CurrentHZK!=LANG_CHT)
                      {
                              tc_Offset=24;
                      }
                      gc_LCM_line=3;
                      gb_LCM_InverseDisp=1;
                      LCM_ShowChar10x16(gc_Hour/10,4+tc_Offset);
                      LCM_ShowChar10x16(gc_Hour%10,14+tc_Offset);
              }
              
              void LCM_ShowCalendarMinute(void)
              {
                      data U8 tc_Offset=0;
              
                      if(gc_CurrentHZK!=LANG_CHS&&gc_CurrentHZK!=LANG_CHT)
                      {
                              tc_Offset=24;
                      }
                      gc_LCM_line=3;
                      gb_LCM_InverseDisp=1;
                      LCM_ShowChar10x16(gc_Min/10,30+tc_Offset);
                      LCM_ShowChar10x16(gc_Min%10,40+tc_Offset);
              }
              
              void LCM_ShowCalendarSecond(void)
              {
                      data U8 tc_Offset=0;
              
                      if(gc_CurrentHZK!=LANG_CHS&&gc_CurrentHZK!=LANG_CHT)
                      {
                              tc_Offset=24;
                      }
                      gc_LCM_line=3;
                      gb_LCM_InverseDisp=1;
                      LCM_ShowChar10x16(gc_Sec/10,56+tc_Offset);
                      LCM_ShowChar10x16(gc_Sec%10,66+tc_Offset);
              }
              
              void LCM_ShowCalendarWeek(void)
              {
                      data    U8      i;
                      xdata   U8      tc_w;
                      xdata   U8      *p;
              
                      switch(gc_Week)
                      {
                              case 0: // Monday
                                      p=gc_Str_Monday[gc_CurrentHZK];
                              break;
              
                              case 1: // Tuesday
                                      p=gc_Str_Tuesday[gc_CurrentHZK];
C51 COMPILER V9.00   LCM_DISPLAY4                                                          07/09/2012 21:16:49 PAGE 13  

                              break;
              
                              case 2: // Wednesday
                                      p=gc_Str_Wednesday[gc_CurrentHZK];
                              break;
              
                              case 3: // Thursday
                                      p=gc_Str_Thursday[gc_CurrentHZK];
                              break;
              
                              case 4: // Friday
                                      p=gc_Str_Friday[gc_CurrentHZK];
                              break;
              
                              case 5: // Saturday
                                      p=gc_Str_Saturday[gc_CurrentHZK];
                              break;
              
                              case 6: // Sunday
                                      p=gc_Str_Sunday[gc_CurrentHZK];
                              break;
                      }
              
                      for(i=0;i<p[0];i++)
                      {
                              gc_LrcDisplayBuf[i]=p[1+i];
                      }
              
                      if(gc_CurrentHZK==LANG_CHS||gc_CurrentHZK==LANG_CHT)
                      {
                              LCM_DisplayMenuString(&gc_LrcDisplayBuf,p[0],112,24,0);
                      }
                      else
                      {
                              LCM_Clear_L6_L7();
                              if(gc_CurrentHZK==LANG_JAP||gc_CurrentHZK==LANG_KOR)
                              {
                                      tc_w=8;
                              }
                              else
                              {
                                      tc_w=4;
                              }
                              LCM_DisplayMenuString(&gc_LrcDisplayBuf,p[0],(128-tc_w*p[0])/2,48,0);
                      }
              }
              
              
              void LCM_ShowLunar(void)
              {
                      xdata   U8      tc_temp;
                      // ¥Ò¤A¤þ¤B¥³¤v©°¨¯¤Ð¬Ñ
                      code U8 K_Str_DiZhi[]={0x32,0x75,0x59,0x4E,0x19,0x4E,0x01,0x4E,0x0A,0x62,0xF1,0x5D,0x9A,0x5E,0x9B,0x8F,0x
             -EC,0x58,0x78,0x76};   
                      // ¤l¤¡±G¥f¨°¤x¤È¥¼¥Ó¨»¦¦¥è
                      code U8 K_Str_Tiangan[]={0x50,0x5B,0x11,0x4E,0xC5,0x5B,0x6F,0x53,0xB0,0x8F,0xF3,0x5D,0x48,0x53,0x2A,0x67,
             -0x33,0x75,0x49,0x91,0x0C,0x62,0xA5,0x4E};     
                      // ¥¿¤G¤T¥|¤­¤»¤C¤K¤E¤Q¥VÃ¾
                      code U8 K_Str_LunarMonth[]={0x63,0x6B,0x8C,0x4E,0x09,0x4E,0xDB,0x56,0x94,0x4E,0x6D,0x51,0x03,0x4E,0x6B,0x
             -51,0x5D,0x4E,0x41,0x53,0xAC,0x51,0xD8,0x81};
              
                      // Display Lunar Year
C51 COMPILER V9.00   LCM_DISPLAY4                                                          07/09/2012 21:16:49 PAGE 14  

                      gb_LCM_InverseDisp=0;
                      gc_LrcDisplayBuf[0]=K_Str_DiZhi[gc_Dizhi*2+0];
                      gc_LrcDisplayBuf[1]=K_Str_DiZhi[gc_Dizhi*2+1];
                      gc_LrcDisplayBuf[2]=K_Str_Tiangan[gc_Tiangan*2+0];
                      gc_LrcDisplayBuf[3]=K_Str_Tiangan[gc_Tiangan*2+1];
                      LCM_DisplayMenuString(&gc_LrcDisplayBuf,4,0,48,0);
                      // Display Lunar Month
                      if(gc_Month_Lunar==12&&gc_CurrentHZK==LANG_CHS)
                      {
                              gc_LrcDisplayBuf[0]=0x4A;       // ÛK
                              gc_LrcDisplayBuf[1]=0x81;
                      }
                      else
                      {
                              gc_LrcDisplayBuf[0]=K_Str_LunarMonth[gc_Month_Lunar*2-2];
                              gc_LrcDisplayBuf[1]=K_Str_LunarMonth[gc_Month_Lunar*2-1];
                      }
                      LCM_DisplayMenuString(&gc_LrcDisplayBuf,2,48,48,0);
                      // Display Lunar Day
                      if(gc_Day_Lunar%10==0)
                      {
                              if(gc_Day_Lunar/10==1)
                              {
                                      gc_LrcDisplayBuf[0]=0x1D;       // ªì
                                      gc_LrcDisplayBuf[1]=0x52;
                              }
                              else if(gc_Day_Lunar/10==2)
                              {
                                      gc_LrcDisplayBuf[0]=0x8C;       // ¤G
                                      gc_LrcDisplayBuf[1]=0x4E;
                              }
                              else
                              {
                                      gc_LrcDisplayBuf[0]=0x09;       // ¤T
                                      gc_LrcDisplayBuf[1]=0x4E;                       
                              }
                              gc_LrcDisplayBuf[2]=0x41;       // ¤Q
                              gc_LrcDisplayBuf[3]=0x53;                       
                      }
                      else
                      {
                              if(gc_Day_Lunar/10==0)
                              {
                                      gc_LrcDisplayBuf[0]=0x1D;       // ªì
                                      gc_LrcDisplayBuf[1]=0x52;
                              }
                              else if(gc_Day_Lunar/10==1)
                              {
                                      gc_LrcDisplayBuf[0]=0x41;       // ¤Q
                                      gc_LrcDisplayBuf[1]=0x53;                       
                              }
                              else
                              {
                                      gc_LrcDisplayBuf[0]=0xFF;       // ¤Ü
                                      gc_LrcDisplayBuf[1]=0x5E;                       
                              }
              
                              tc_temp=gc_Day_Lunar%10;
                              if(tc_temp==1)
                              {
                                      gc_LrcDisplayBuf[2]=0x00;       // ¤@
                                      gc_LrcDisplayBuf[3]=0x4E;
C51 COMPILER V9.00   LCM_DISPLAY4                                                          07/09/2012 21:16:49 PAGE 15  

                              }
                              else
                              {
                                      gc_LrcDisplayBuf[2]=K_Str_LunarMonth[tc_temp*2-2];
                                      gc_LrcDisplayBuf[3]=K_Str_LunarMonth[tc_temp*2-1];
                              }
                      }
                      LCM_DisplayMenuString(&gc_LrcDisplayBuf,4,80,48,0);
                      // Display Leap-month
                      if(gb_LeapMonth==1)
                      {
                              gb_LCM_InverseDisp=1;
                              if(gc_CurrentHZK==LANG_CHS)
                              {
                                      gc_LrcDisplayBuf[0]=0xF0;       // …z
                                      gc_LrcDisplayBuf[1]=0x95;
                              }
                              else    // CHT
                              {
                                      gc_LrcDisplayBuf[0]=0x8F;       // ¶|
                                      gc_LrcDisplayBuf[1]=0x95;
                              }
                              LCM_DisplayMenuString(&gc_LrcDisplayBuf,2,112,48,0);
                      }
                      else
                      {
                              gc_LrcDisplayBuf[0]=0x20;
                              gc_LrcDisplayBuf[1]=0x00;
                              gc_LrcDisplayBuf[2]=0x20;
                              gc_LrcDisplayBuf[3]=0x00;
                              LCM_DisplayMenuString(&gc_LrcDisplayBuf,4,112,48,0);
                      }
              }
              
              void LCM_ShowAlarmClockString(void)
              {
                      data    U8      i;
                      xdata   U8      *p;
              
                      p=gc_Str_AlarmClock[gc_CurrentHZK];
                      for(i=0;i<p[0];i++)
                      {
                              gc_LrcDisplayBuf[i]=p[1+i];
                      }
              
                      LCM_DisplayMenuString(&gc_LrcDisplayBuf,p[0],0,0,0);
              }
              
              void LCM_ShowTimeString(void)
              {
                      data    U8      i;
                      xdata   U8      *p;
              
                      p=gc_Str_Time[gc_CurrentHZK];
                      for(i=0;i<p[0];i++)
                      {
                              gc_LrcDisplayBuf[i]=p[1+i];
                      }
              
                      LCM_DisplayMenuString(&gc_LrcDisplayBuf,p[0],0,16,0);
              }
              
C51 COMPILER V9.00   LCM_DISPLAY4                                                          07/09/2012 21:16:49 PAGE 16  

              void LCM_ShowRepeatString(void)
              {
                      data    U8      i;
                      xdata   U8      *p;
              
                      p=gc_Str_AlarmRepeat[gc_CurrentHZK];
                      for(i=0;i<p[0];i++)
                      {
                              gc_LrcDisplayBuf[i]=p[1+i];
                      }
              
                      LCM_DisplayMenuString(&gc_LrcDisplayBuf,p[0],0,32,0);
              }
              
              void LCM_ShowDaysString(U8 tc_Day)
              {
                      data    U8      i;
                      data    U8      x;
                      xdata   U8      *p;
              
                      switch(tc_Day)
                      {
                              case 0: // Monday
                                      p=gc_Str_Monday[gc_CurrentHZK];
                              break;
              
                              case 1: // Tuesday
                                      p=gc_Str_Tuesday[gc_CurrentHZK];
                              break;
              
                              case 2: // Wednesday
                                      p=gc_Str_Wednesday[gc_CurrentHZK];
                              break;
              
                              case 3: // Thursday
                                      p=gc_Str_Thursday[gc_CurrentHZK];
                              break;
              
                              case 4: // Friday
                                      p=gc_Str_Friday[gc_CurrentHZK];
                              break;
              
                              case 5: // Saturday
                                      p=gc_Str_Saturday[gc_CurrentHZK];
                              break;
              
                              case 6: // Sunday
                                      p=gc_Str_Sunday[gc_CurrentHZK];
                              break;
              
                              case 7: // Exit
                                      p=gc_Str_Exit[gc_CurrentHZK];
                                      LCM_Clear_L6_L7();
                              break;
                      }
                      if((gc_CurrentHZK==LANG_CHS||gc_CurrentHZK==LANG_CHT)&&tc_Day!=7)
                      {
                              gc_LrcDisplayBuf[0]=0x1F;       // ¬P´Á
                              gc_LrcDisplayBuf[1]=0x66;
                              gc_LrcDisplayBuf[2]=0x1F;
                              gc_LrcDisplayBuf[3]=0x67;
                              gc_LrcDisplayBuf[4]=p[1];
C51 COMPILER V9.00   LCM_DISPLAY4                                                          07/09/2012 21:16:49 PAGE 17  

                              gc_LrcDisplayBuf[5]=p[2];
                              x=4;
                      }
                      else
                      {
                              x=0;
                              for(i=0;i<p[0];i++)
                              {
                                      gc_LrcDisplayBuf[i]=p[1+i];
                              }
                      }
              
                      gb_LCM_InverseDisp=0;
                      if(tc_Day==gc_AlarmRepeat_DaySelect)
                      {
                              gb_LCM_InverseDisp=1;
                      }
                      LCM_DisplayMenuString(&gc_LrcDisplayBuf,p[0]+x,16,(tc_Day%4)*16,1);
              }
              
              void LCM_ShowDaysSelect(void)
              {
                      data    U8      i;
                      data    U8      k;
                      data    U8      tc_DaySelect;
                      data    U8      tc_Count;
                      xdata   U8      j;
                      xdata   U16     tw_Addr;
              
                      gb_LCM_InverseDisp=0;
                      tc_DaySelect=gc_AlarmDaysSelect;
                      if(gc_AlarmRepeat_DaySelect<4)
                      {
                              tc_Count=4;
                      }
                      else
                      {
                              tc_Count=3;
                              tc_DaySelect=tc_DaySelect>>4;
                      }
              
                      for(k=0;k<tc_Count;k++)
                      {
                              tw_Addr=Select16x16;
                              if(tc_DaySelect&0x01)
                              {
                                      tw_Addr+=32;
                              }
                              tc_DaySelect=tc_DaySelect>>1;
                              LCM_ReadSPIBMPdata(tw_Addr,32);
                              for(i=0;i<2;i++)
                              {
                                      LCM_set_address(i+k*2,0);
                                      for(j=0;j<16;j++)
                                      {
                                              LCM_write_data(gc_DirLCMtempBuf[i*16+j]);
                                      }
                              }
                      }
              }
              #endif

C51 COMPILER V9.00   LCM_DISPLAY4                                                          07/09/2012 21:16:49 PAGE 18  


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   2284    ----
   CONSTANT SIZE    =     68    ----
   XDATA SIZE       =   ----      31
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      18
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
