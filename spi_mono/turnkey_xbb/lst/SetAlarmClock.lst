C51 COMPILER V9.00   SETALARMCLOCK                                                         07/09/2012 21:16:54 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE SETALARMCLOCK
OBJECT MODULE PLACED IN .\obj\SetAlarmClock.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE Setup\SetAlarmClock.c LARGE OPTIMIZE(9,SIZE) BROWSE NOAREGS INCDIR(..\libso
                    -urce\header) DEFINE(K_ICTYPE=0x03) DEBUG OBJECTEXTEND PRINT(.\lst\SetAlarmClock.lst) OBJECT(.\obj\SetAlarmClock.obj)

line level    source

   1          #include "..\Header\SPDA2K.h"
   2          #include "..\header\variables.h"
   3          
   4          void SetAlarmClock(void)
   5          {
   6   1              data    bit     tb_AlarmON;
   7   1              data    bit     tb_AlarmRepeatON;
   8   1              data    U8      tc_temp;
   9   1      
  10   1              tb_AlarmON=gb_AlarmON;
  11   1              tb_AlarmRepeatON=gb_AlarmRepeatON;
  12   1              gdw_AlarmTime_Bak=gdw_AlarmTime;
  13   1              LCM_Clear_L0_L7();
  14   1              gb_LCM_InverseDisp=1;
  15   1              LCM_ShowAlarmONOFFString();
  16   1              gb_LCM_InverseDisp=0;
  17   1              LCM_ShowAlarmClockString();
  18   1              LCM_ShowTimeString();
  19   1              LCM_ShowRepeatString();
  20   1              LCM_ShowAlarmTime_Hour();
  21   1              LCM_ShowChar8x16(10,87);        // :
  22   1              LCM_ShowAlarmTime_Minute();
  23   1              LCM_ShowAlarmRepeatONOFFString();
  24   1              gc_SetAlarmStep=0;
  25   1              while(1)
  26   1              {
  27   2                      Key_Detect();
  28   2                      if(gc_KeyEvent!=0)
  29   2                      {
  30   3                              gc_MenuTimer=6; // Reset Function Menu timer
  31   3                              switch(gc_KeyEvent)
  32   3                              {
  33   4                                      case 0x03:      // Next
  34   4                                              gb_LCM_InverseDisp=1;
  35   4                                              if(gc_SetAlarmStep==0)
  36   4                                              {
  37   5                                                      gb_AlarmON=!gb_AlarmON;
  38   5                                                      LCM_ShowAlarmONOFFString();
  39   5                                              }
  40   4                                              else if(gc_SetAlarmStep==1)
  41   4                                              {
  42   5                                                      gdw_AlarmTime+=3600;
  43   5                                                      if(gdw_AlarmTime>=86400)
  44   5                                                      {
  45   6                                                              gdw_AlarmTime-=86400;
  46   6                                                      }
  47   5                                                      LCM_ShowAlarmTime_Hour();
  48   5                                              }
  49   4                                              else if(gc_SetAlarmStep==2)
  50   4                                              {
  51   5                                                      if(gdw_AlarmTime%3600==3540)
  52   5                                                      {
  53   6                                                              gdw_AlarmTime-=3540;
  54   6                                                      }
C51 COMPILER V9.00   SETALARMCLOCK                                                         07/09/2012 21:16:54 PAGE 2   

  55   5                                                      else
  56   5                                                      {
  57   6                                                              gdw_AlarmTime+=60;
  58   6                                                      }
  59   5                                                      LCM_ShowAlarmTime_Minute();
  60   5                                              }
  61   4                                              else if(gc_SetAlarmStep==3)
  62   4                                              {
  63   5                                                      gb_AlarmRepeatON=!gb_AlarmRepeatON;
  64   5                                                      gb_LCM_InverseDisp=1;
  65   5                                                      LCM_ShowAlarmRepeatONOFFString();
  66   5                                              }
  67   4                                              else
  68   4                                              {
  69   5                                                      if(gc_AlarmRepeat_DaySelect==3)
  70   5                                                      {
  71   6                                                              gc_AlarmRepeat_DaySelect=4;
  72   6                                                              LCM_ShowDaysString(4);
  73   6                                                              LCM_ShowDaysString(5);
  74   6                                                              LCM_ShowDaysString(6);
  75   6                                                              LCM_ShowDaysString(7);
  76   6                                                      }
  77   5                                                      else if(gc_AlarmRepeat_DaySelect==7)
  78   5                                                      {
  79   6                                                              gc_AlarmRepeat_DaySelect=0;
  80   6                                                              LCM_ShowDaysString(0);
  81   6                                                              LCM_ShowDaysString(1);
  82   6                                                              LCM_ShowDaysString(2);
  83   6                                                              LCM_ShowDaysString(3);
  84   6                                                      }
  85   5                                                      else
  86   5                                                      {
  87   6                                                              gc_AlarmRepeat_DaySelect++;
  88   6                                                              LCM_ShowDaysString(gc_AlarmRepeat_DaySelect-1);
  89   6                                                              LCM_ShowDaysString(gc_AlarmRepeat_DaySelect);
  90   6                                                      }
  91   5                                                      LCM_ShowDaysSelect();
  92   5                                              }
  93   4                                      break;
  94   4      
  95   4                                      case 0x04:      // Prev
  96   4                                              gb_LCM_InverseDisp=1;
  97   4                                              if(gc_SetAlarmStep==0)
  98   4                                              {
  99   5                                                      gb_AlarmON=!gb_AlarmON;
 100   5                                                      gb_LCM_InverseDisp=1;
 101   5                                                      LCM_ShowAlarmONOFFString();
 102   5                                              }
 103   4                                              else if(gc_SetAlarmStep==1)
 104   4                                              {
 105   5                                                      if(gdw_AlarmTime<3600)
 106   5                                                      {
 107   6                                                              gdw_AlarmTime+=86400-3600;
 108   6                                                      }
 109   5                                                      else
 110   5                                                      {
 111   6                                                              gdw_AlarmTime-=3600;
 112   6                                                      }
 113   5                                                      LCM_ShowAlarmTime_Hour();
 114   5                                              }
 115   4                                              else if(gc_SetAlarmStep==2)
 116   4                                              {
C51 COMPILER V9.00   SETALARMCLOCK                                                         07/09/2012 21:16:54 PAGE 3   

 117   5                                                      if(gdw_AlarmTime%3600<60)
 118   5                                                      {
 119   6                                                              gdw_AlarmTime+=3600-60;
 120   6                                                      }
 121   5                                                      else
 122   5                                                      {
 123   6                                                              gdw_AlarmTime-=60;
 124   6                                                      }
 125   5                                                      LCM_ShowAlarmTime_Minute();
 126   5                                              }
 127   4                                              else if(gc_SetAlarmStep==3)
 128   4                                              {
 129   5                                                      gb_AlarmRepeatON=!gb_AlarmRepeatON;
 130   5                                                      gb_LCM_InverseDisp=1;
 131   5                                                      LCM_ShowAlarmRepeatONOFFString();
 132   5                                              }
 133   4                                              else
 134   4                                              {
 135   5                                                      if(gc_AlarmRepeat_DaySelect==0)
 136   5                                                      {
 137   6                                                              gc_AlarmRepeat_DaySelect=7;
 138   6                                                              LCM_ShowDaysString(4);
 139   6                                                              LCM_ShowDaysString(5);
 140   6                                                              LCM_ShowDaysString(6);
 141   6                                                              LCM_ShowDaysString(7);
 142   6                                                      }
 143   5                                                      else if(gc_AlarmRepeat_DaySelect==4)
 144   5                                                      {
 145   6                                                              gc_AlarmRepeat_DaySelect=3;
 146   6                                                              LCM_ShowDaysString(0);
 147   6                                                              LCM_ShowDaysString(1);
 148   6                                                              LCM_ShowDaysString(2);
 149   6                                                              LCM_ShowDaysString(3);
 150   6                                                      }
 151   5                                                      else
 152   5                                                      {
 153   6                                                              gc_AlarmRepeat_DaySelect--;
 154   6                                                              LCM_ShowDaysString(gc_AlarmRepeat_DaySelect+1);
 155   6                                                              LCM_ShowDaysString(gc_AlarmRepeat_DaySelect);
 156   6                                                      }
 157   5                                                      LCM_ShowDaysSelect();
 158   5                                              }
 159   4                                      break;
 160   4      
 161   4                                      case 0x06:      // M
 162   4                                              if(gc_SetAlarmStep==0)
 163   4                                              {
 164   5                                                      gb_LCM_InverseDisp=0;
 165   5                                                      if(gb_AlarmON==0)
 166   5                                                      {
 167   6                                                              gc_Task_Current=C_Task_Setup;
 168   6                                                              USER_LogFile_ReadWrite(1);
 169   6                                                              return;
 170   6                                                      }
 171   5                                                      LCM_ShowAlarmONOFFString();
 172   5                                                      gb_LCM_InverseDisp=1;
 173   5                                                      LCM_ShowAlarmTime_Hour();
 174   5                                              }
 175   4                                              else if(gc_SetAlarmStep==1)
 176   4                                              {
 177   5                                                      gb_LCM_InverseDisp=0;
 178   5                                                      LCM_ShowAlarmTime_Hour();
C51 COMPILER V9.00   SETALARMCLOCK                                                         07/09/2012 21:16:54 PAGE 4   

 179   5                                                      gb_LCM_InverseDisp=1;
 180   5                                                      LCM_ShowAlarmTime_Minute();
 181   5                                              }
 182   4                                              else if(gc_SetAlarmStep==2)
 183   4                                              {
 184   5                                                      gb_LCM_InverseDisp=0;
 185   5                                                      LCM_ShowAlarmTime_Minute();
 186   5                                                      gb_LCM_InverseDisp=1;
 187   5                                                      LCM_ShowAlarmRepeatONOFFString();
 188   5                                              }
 189   4                                              else if(gc_SetAlarmStep==3)
 190   4                                              {
 191   5                                                      if(gb_AlarmRepeatON==0)
 192   5                                                      {
 193   6                                                              gc_Task_Current=C_Task_Setup;
 194   6                                                              gb_LCM_InverseDisp=0;
 195   6                                                              USER_LogFile_ReadWrite(1);
 196   6                                                              return;
 197   6                                                      }
 198   5                                                      else
 199   5                                                      {
 200   6                                                              gb_LCM_InverseDisp=0;
 201   6                                                              LCM_Clear_L0_L7();
 202   6                                                              gc_AlarmRepeat_DaySelect=0;
 203   6                                                              LCM_ShowDaysString(0);
 204   6                                                              LCM_ShowDaysString(1);
 205   6                                                              LCM_ShowDaysString(2);
 206   6                                                              LCM_ShowDaysString(3);
 207   6                                                              LCM_ShowDaysSelect();
 208   6                                                      }
 209   5                                              }
 210   4                                              else
 211   4                                              {
 212   5                                                      if(gc_AlarmRepeat_DaySelect==7) // Exit
 213   5                                                      {
 214   6                                                              gc_Task_Current=C_Task_Setup;
 215   6                                                              gb_LCM_InverseDisp=0;
 216   6                                                              USER_LogFile_ReadWrite(1);
 217   6                                                              return;
 218   6                                                      }
 219   5                                                      tc_temp=1<<gc_AlarmRepeat_DaySelect;
 220   5                                                      if(gc_AlarmDaysSelect&tc_temp)
 221   5                                                      {
 222   6                                                              gc_AlarmDaysSelect&=~tc_temp;
 223   6                                                      }
 224   5                                                      else
 225   5                                                      {
 226   6                                                              gc_AlarmDaysSelect|=tc_temp;
 227   6                                                      }
 228   5                                                      LCM_ShowDaysSelect();
 229   5                                                      gc_SetAlarmStep--;
 230   5                                              }
 231   4                                              gc_SetAlarmStep++;
 232   4                                      break;
 233   4                              }
 234   3                      }
 235   2      
 236   2                      if(gc_MenuTimer==0)
 237   2                      {
 238   3                              gb_LCM_InverseDisp=0;
 239   3                              gc_Task_Current=C_Task_Setup;
 240   3                              gb_AlarmON=tb_AlarmON;
C51 COMPILER V9.00   SETALARMCLOCK                                                         07/09/2012 21:16:54 PAGE 5   

 241   3                              gb_AlarmRepeatON=tb_AlarmRepeatON;
 242   3                              gdw_AlarmTime=gdw_AlarmTime_Bak;
 243   3                              return;
 244   3                      }
 245   2              }
 246   1      }
 247          
 248          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    849    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       1
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----       2
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
