C51 COMPILER V7.10   LOGDATA                                                               02/28/2011 10:30:39 PAGE 1   


C51 COMPILER V7.10, COMPILATION OF MODULE LOGDATA
OBJECT MODULE PLACED IN .\obj\logData.obj
COMPILER INVOKED BY: F:\Keil C 7.10\chengxu\C51\BIN\C51.EXE LogData\logData.c LARGE OPTIMIZE(9,SIZE) BROWSE NOAREGS INCD
                    -IR(..\libsource\header) DEFINE(K_ICTYPE=0x03) DEBUG OBJECTEXTEND PRINT(.\lst\logData.lst) OBJECT(.\obj\logData.obj)

line level    source

   1          #include "..\Header\SPDA2K.h"
   2          #include "..\header\dos\fs_struct.h"
   3          #include "..\header\Memalloc.h"
   4          #include "..\header\variables.h"
   5          
   6          
   7          extern xdata UBYTE gc_RepPlayMode;
   8          extern xdata System_Struct gs_System_State;
   9          
  10          extern bit      gb_DirPlay_Flag;
  11          extern xdata U8  gc_PlayModeChange_Flag;
  12          extern xdata U8  gc_RepPlayMode_Dir;
  13          extern xdata U8  gc_RepPlayMode_Nor;
  14          extern xdata U8  gc_CurrentHZK;
  15          
  16          U8 Read_LogData(void);
  17          U8 Write_LogData(void);
  18          U8 Get_LogData_PageIndex(void);
  19          U8 USER_LogFile_ReadWrite(U8 tbt_ReadOrWrite);//use reserveblock for log
  20          void USER_FillSettingInfo(void);
  21          void USER_GetSettingInfo(void);
  22          
  23          extern  xdata   U8      gc_LanguageSel;
  24          extern  xdata   U8      LanguageTable[];
  25          extern xdata U8 gc_ContrastSaveOrNot;
  26          U8 Get_LogData_PageIndex(void)  
  27          {
  28   1              U8      data tc_i;
  29   1              U8  EmptyPageExists;
  30   1              U16     data tw_j;
  31   1              
  32   1              gc_UIblock0_index=0;    //initial
  33   1              EmptyPageExists=1;              //initial, 假設有空的page               
  34   1      
  35   1              for(tc_i=gw_PagesPerBlock-1;tc_i>=0;tc_i--)//由後往前檢查所有的pages,找出最近一個使用的page
  36   1              {
  37   2                      UserData_Block_Read(0,tc_i*gc_InAddrMax,1,gc_PlayRecordDataBufHB);      //block 0,sector tc_i*G_Card_PageSize
             - , 1 sector(s), source address is 0xAA00
  38   2                      if(gc_PlayRecordDataBuf[508] != 0xFF)
  39   2                      {//check 1 byte first, 不是空的sector
  40   3                              EmptyPageExists=0;      //flag : this sector is not empty               
  41   3                              break;//不是空的即跳出回圈
  42   3                      }
  43   2                      else
  44   2                      {//檢查1 byte後為空的,再確認其他bytes是否為0xFF
  45   3                              for (tw_j=0;tw_j<512;tw_j++)
  46   3                              {//check all bytes
  47   4                                      if (gc_PlayRecordDataBuf[tw_j]!=0xff)
  48   4                                      {//not empty sector
  49   5                                              EmptyPageExists=0;      //flag : this sector is not empty
  50   5                                              break;  //其他byte不需要再檢查
  51   5                                      }
  52   4      
  53   4                              }
C51 COMPILER V7.10   LOGDATA                                                               02/28/2011 10:30:39 PAGE 2   

  54   3                      }
  55   2      
  56   2                      if (!EmptyPageExists)
  57   2                      {//un-empty page found
  58   3      //                      dbprintf("page isn't empty\n");
  59   3                              break;  //停止檢查其他pages
  60   3                      }
  61   2                      
  62   2      
  63   2                      if (tc_i==0)
  64   2                      {//last checked page,表示整個block都是空的
  65   3                              break;  //avoid tc_i=0-1=0xFF
  66   3              }
  67   2              
  68   2              }//end,for(tc_i=gc_PagesPerBlock-1;tc_i>=0;tc_i--)
  69   1      
  70   1              if (EmptyPageExists)
  71   1              {//all are empty pages(tc_i=0~127 & EmptyPageExists=1)
  72   2                      gc_UIblock0_index =tc_i-1;      //
  73   2              }
  74   1              else
  75   1              {//found 有資料的page(tc_i=0 & EmptyPageExists=0)
  76   2                      gc_UIblock0_index =tc_i;//
  77   2              }
  78   1      
  79   1      //      dbprintf("last LogData at page %bx \n",gc_UIblock0_index);      
  80   1      
  81   1              return 0;
  82   1      }
  83          
  84          
  85          U8 Read_LogData(void)  
  86          {
  87   1              bit     tb_ReadWriteDataArea;
  88   1              
  89   1              tb_ReadWriteDataArea=gb_ReadWriteDataArea;
  90   1              gb_ReadWriteDataArea = 0;
  91   1              
  92   1              EA=0;
  93   1      
  94   1              if (gc_UIblock0_index==0xFF)
  95   1              {//1st page是空的
  96   2              }
  97   1              else
  98   1              {
  99   2                      UserData_Block_Read(0,gc_UIblock0_index*gc_InAddrMax,1,gc_PlayRecordDataBufHB); //block 0,sector gc_UIbl
             -ock0_index*G_Card_PageSize , 1 sector(s), source address is 0xAA00
 100   2              }
 101   1      
 102   1              EA=1;
 103   1              gb_ReadWriteDataArea=tb_ReadWriteDataArea;      //restore
 104   1              return 0;
 105   1      }       
 106          
 107          U8 Write_LogData(void)  
 108          {
 109   1              bit     tb_ReadWriteDataArea;
 110   1      
 111   1              tb_ReadWriteDataArea=gb_ReadWriteDataArea;
 112   1              gb_ReadWriteDataArea = 0;
 113   1      
 114   1              if(gc_UIblock0_index==(gw_PagesPerBlock-1))//already write last page,gc_UIblock0_index為上一筆資訊
C51 COMPILER V7.10   LOGDATA                                                               02/28/2011 10:30:39 PAGE 3   

 115   1              {//如果上一筆已經是最後一個page -> erase 1 block
 116   2      
 117   2                      UserData_Block_Erase(0);        
 118   2                      gc_UIblock0_index=0;    //從sector 0開始寫
 119   2              }
 120   1              else if (gc_UIblock0_index==0xFF)
 121   1              {//1st page是空的
 122   2                      gc_UIblock0_index=0;    //從sector 0開始寫
 123   2              }
 124   1              else
 125   1              {
 126   2                      gc_UIblock0_index=gc_UIblock0_index+1;  //從最後一page有資料的下一page開始寫
 127   2              }       
 128   1      
 129   1              //mark LogDATA valid
 130   1              gc_PlayRecordDataBuf[508] = 'L' ;       //0x4c
 131   1              gc_PlayRecordDataBuf[509] = 'O' ;       //0x4f
 132   1              gc_PlayRecordDataBuf[510] = 'G' ;       //0x47  
 133   1              gc_PlayRecordDataBuf[511] = 'D' ;       //0x44
 134   1      
 135   1              EA=0;
 136   1              UserData_Block_Write(0,gc_UIblock0_index*gc_InAddrMax,1,gc_PlayRecordDataBufHB);        //block 0,sector gc_UIbl
             -ock0_index*G_Card_PageSize , 1 sector(s), source address is 0xAA00
 137   1              EA=1;
 138   1              gb_ReadWriteDataArea=tb_ReadWriteDataArea;      //restore buffer assignment
 139   1              return 0;
 140   1      }
 141          
 142          
 143          void USER_GetSettingInfo(void)
 144          {
 145   1              gs_DSP_GLOBAL_RAM.sw_Volume = gc_PlayRecordDataBuf[0];
 146   1              gs_DSP_GLOBAL_RAM.sc_EQ_Type = gc_PlayRecordDataBuf[1];
 147   1              gc_RepPlayMode=gc_PlayRecordDataBuf[2];
 148   1      //      gc_RepPlayMode = gc_RepPlayMode;
 149   1              gc_LanguageSel=gc_PlayRecordDataBuf[22];
 150   1              gc_Contrast = gc_PlayRecordDataBuf[39];
 151   1              gc_ContrastSaveOrNot=gc_PlayRecordDataBuf[40];
 152   1              if(gc_ContrastSaveOrNot > 1) 
 153   1          { 
 154   2              gc_ContrastSaveOrNot = 0; 
 155   2          } 
 156   1      
 157   1              if(gc_LanguageSel>17)
 158   1              {
 159   2                      gc_LanguageSel=HZK_LANGUAGE;
 160   2              }
 161   1              gc_MenuHZK=gc_LanguageSel;//LanguageTable[gc_LanguageSel];//sunzhk modify
 162   1      
 163   1              gw_FM_frequency=((U16)(gc_PlayRecordDataBuf[3])<<8) + (U16)gc_PlayRecordDataBuf[4];
 164   1      
 165   1              if(gc_PlayModeChange_Flag==0)
 166   1              {
 167   2                      if(gc_PlayRecordDataBuf[20]<2)
 168   2                      {
 169   3                              gb_DirPlay_Flag = gc_PlayRecordDataBuf[20];
 170   3                      }
 171   2                      else
 172   2                      {
 173   3                              gb_DirPlay_Flag=0;      
 174   3                      }
 175   2              }
C51 COMPILER V7.10   LOGDATA                                                               02/28/2011 10:30:39 PAGE 4   

 176   1      
 177   1              gw_LogFileIndex=((U16)(gc_PlayRecordDataBuf[5])<<8) + (U16)gc_PlayRecordDataBuf[6];
 178   1              gw_SDLogFileIndex=((U16)(gc_PlayRecordDataBuf[7])<<8) + (U16)gc_PlayRecordDataBuf[8];
 179   1              gw_USBLogFileIndex=((U16)(gc_PlayRecordDataBuf[9])<<8) + (U16)gc_PlayRecordDataBuf[10];
 180   1              gw_DIRFileIndex=((U16)(gc_PlayRecordDataBuf[15])<<8) + (U16)gc_PlayRecordDataBuf[16];
 181   1              gdw_DIRFDB_StartCluster=((U32)(gc_PlayRecordDataBuf[11]) <<24) + ((U32)gc_PlayRecordDataBuf[12] <<16) + (
             -(U32)gc_PlayRecordDataBuf[13] << 8) + (U32)gc_PlayRecordDataBuf[14];
 182   1              gw_DIRFileTotalNumber=((U16)(gc_PlayRecordDataBuf[18])<<8) + (U16)gc_PlayRecordDataBuf[19];
 183   1      
 184   1              gw_SDDIRFileIndex=((U16)(gc_PlayRecordDataBuf[27])<<8) + (U16)gc_PlayRecordDataBuf[28];  //20090216 chiay
             -en add
 185   1              gdw_SDDIRFDB_StartCluster=((U32)(gc_PlayRecordDataBuf[23]) <<24) + ((U32)gc_PlayRecordDataBuf[24] <<16) +
             - ((U32)gc_PlayRecordDataBuf[25] << 8) + (U32)gc_PlayRecordDataBuf[26];
 186   1              gw_SDDIRFileTotalNumber=((U16)(gc_PlayRecordDataBuf[29])<<8) + (U16)gc_PlayRecordDataBuf[30];
 187   1      
 188   1              gw_HostDIRFileIndex=((U16)(gc_PlayRecordDataBuf[35])<<8) + (U16)gc_PlayRecordDataBuf[36];  //20090216 chi
             -ayen add
 189   1              gdw_HostDIRFDB_StartCluster=((U32)(gc_PlayRecordDataBuf[31]) <<24) + ((U32)gc_PlayRecordDataBuf[32] <<16)
             - + ((U32)gc_PlayRecordDataBuf[33] << 8) + (U32)gc_PlayRecordDataBuf[34];
 190   1              gw_HostDIRFileTotalNumber=((U16)(gc_PlayRecordDataBuf[37])<<8) + (U16)gc_PlayRecordDataBuf[38];
 191   1      
 192   1              if(gb_DirPlay_Flag==1)
 193   1              {
 194   2                      if(gc_CurrentCard==0)  //20090216 chiayen add
 195   2                      {
 196   3                              ((U8 *)(&gs_File_FCB[0].dw_FDB_StartCluster))[0] = gc_PlayRecordDataBuf[11];
 197   3                              ((U8 *)(&gs_File_FCB[0].dw_FDB_StartCluster))[1] = gc_PlayRecordDataBuf[12];
 198   3                              ((U8 *)(&gs_File_FCB[0].dw_FDB_StartCluster))[2] = gc_PlayRecordDataBuf[13];
 199   3                              ((U8 *)(&gs_File_FCB[0].dw_FDB_StartCluster))[3] = gc_PlayRecordDataBuf[14];
 200   3      
 201   3                              ((U8 *)(&gw_FileIndex[0]))[0] = gc_PlayRecordDataBuf[15];
 202   3                              ((U8 *)(&gw_FileIndex[0]))[1] = gc_PlayRecordDataBuf[16];
 203   3              
 204   3                              ((U8 *)(&gw_FileTotalNumber[0]))[0] = gc_PlayRecordDataBuf[18];
 205   3                              ((U8 *)(&gw_FileTotalNumber[0]))[1] = gc_PlayRecordDataBuf[19];
 206   3                      }
 207   2                      else if(gc_CurrentCard==2) //SD CARD
 208   2                      {
 209   3                              ((U8 *)(&gs_File_FCB[0].dw_FDB_StartCluster))[0] = gc_PlayRecordDataBuf[23];
 210   3                              ((U8 *)(&gs_File_FCB[0].dw_FDB_StartCluster))[1] = gc_PlayRecordDataBuf[24];
 211   3                              ((U8 *)(&gs_File_FCB[0].dw_FDB_StartCluster))[2] = gc_PlayRecordDataBuf[25];
 212   3                              ((U8 *)(&gs_File_FCB[0].dw_FDB_StartCluster))[3] = gc_PlayRecordDataBuf[26];
 213   3                              ((U8 *)(&gw_FileIndex[0]))[0] = gc_PlayRecordDataBuf[27];
 214   3                              ((U8 *)(&gw_FileIndex[0]))[1] = gc_PlayRecordDataBuf[28];
 215   3                              ((U8 *)(&gw_FileTotalNumber[0]))[0] = gc_PlayRecordDataBuf[29];
 216   3                              ((U8 *)(&gw_FileTotalNumber[0]))[1] = gc_PlayRecordDataBuf[30];                 
 217   3                      }
 218   2                      else if(gc_CurrentCard==5)  //HOST
 219   2                      {
 220   3                              ((U8 *)(&gs_File_FCB[0].dw_FDB_StartCluster))[0] = gc_PlayRecordDataBuf[31];
 221   3                              ((U8 *)(&gs_File_FCB[0].dw_FDB_StartCluster))[1] = gc_PlayRecordDataBuf[32];
 222   3                              ((U8 *)(&gs_File_FCB[0].dw_FDB_StartCluster))[2] = gc_PlayRecordDataBuf[33];
 223   3                              ((U8 *)(&gs_File_FCB[0].dw_FDB_StartCluster))[3] = gc_PlayRecordDataBuf[34];
 224   3                              ((U8 *)(&gw_FileIndex[0]))[0] = gc_PlayRecordDataBuf[35];
 225   3                              ((U8 *)(&gw_FileIndex[0]))[1] = gc_PlayRecordDataBuf[36];
 226   3                              ((U8 *)(&gw_FileTotalNumber[0]))[0] = gc_PlayRecordDataBuf[37];
 227   3                              ((U8 *)(&gw_FileTotalNumber[0]))[1] = gc_PlayRecordDataBuf[38];
 228   3                      }
 229   2              }
 230   1              gc_PlayModeChange_Flag=0;
 231   1      }
 232          
C51 COMPILER V7.10   LOGDATA                                                               02/28/2011 10:30:39 PAGE 5   

 233          
 234          void USER_FillSettingInfo(void)
 235          {
 236   1              if(gb_DirPlay_Flag==0)
 237   1              {
 238   2                      if(gc_CurrentCard==0)
 239   2                      {
 240   3                              gw_LogFileIndex=gw_FileIndex[0];        
 241   3                      }
 242   2                      else if(gc_CurrentCard==2)
 243   2                      {
 244   3                              gw_SDLogFileIndex=gw_FileIndex[0];              
 245   3                      }
 246   2                      else if(gc_CurrentCard==5)
 247   2                      {
 248   3                              gw_USBLogFileIndex=gw_FileIndex[0];             
 249   3                      }
 250   2                      gc_PlayRecordDataBuf[5] = (U8)(gw_LogFileIndex >>8);//Nand
 251   2                      gc_PlayRecordDataBuf[6] = (U8) gw_LogFileIndex;//Nand           
 252   2                      gc_PlayRecordDataBuf[7] = (U8)(gw_SDLogFileIndex >>8);//SD
 253   2                      gc_PlayRecordDataBuf[8] = (U8) gw_SDLogFileIndex;//SD
 254   2                      gc_PlayRecordDataBuf[9] = (U8)(gw_USBLogFileIndex >>8);//USB
 255   2                      gc_PlayRecordDataBuf[10] = (U8)gw_USBLogFileIndex;//USB
 256   2      
 257   2                      gc_PlayRecordDataBuf[11] = (U8)(gdw_DIRFDB_StartCluster >>24);
 258   2                      gc_PlayRecordDataBuf[12] = (U8)(gdw_DIRFDB_StartCluster>>16);
 259   2                      gc_PlayRecordDataBuf[13] = (U8)(gdw_DIRFDB_StartCluster>>8);
 260   2                      gc_PlayRecordDataBuf[14] = (U8) gdw_DIRFDB_StartCluster;
 261   2      
 262   2                      gc_PlayRecordDataBuf[15] = (U8)(gw_DIRFileIndex >>8);
 263   2                      gc_PlayRecordDataBuf[16] = (U8) gw_DIRFileIndex ;
 264   2      
 265   2                      gc_PlayRecordDataBuf[18] = (U8)(gw_DIRFileTotalNumber >>8);
 266   2                      gc_PlayRecordDataBuf[19] = (U8) gw_DIRFileTotalNumber ;
 267   2      
 268   2                      gc_PlayRecordDataBuf[23] = (U8)(gdw_SDDIRFDB_StartCluster >>24);  //20090216 chiayen add
 269   2                      gc_PlayRecordDataBuf[24] = (U8)(gdw_SDDIRFDB_StartCluster>>16);
 270   2                      gc_PlayRecordDataBuf[25] = (U8)(gdw_SDDIRFDB_StartCluster>>8);
 271   2                      gc_PlayRecordDataBuf[26] = (U8) gdw_SDDIRFDB_StartCluster;
 272   2                      gc_PlayRecordDataBuf[27] = (U8)(gw_SDDIRFileIndex >>8);
 273   2                      gc_PlayRecordDataBuf[28] = (U8) gw_SDDIRFileIndex;
 274   2                      gc_PlayRecordDataBuf[29] = (U8)(gw_SDDIRFileTotalNumber >>8);
 275   2                      gc_PlayRecordDataBuf[30] = (U8) gw_SDDIRFileTotalNumber;
 276   2      
 277   2                      gc_PlayRecordDataBuf[31] = (U8)(gdw_HostDIRFDB_StartCluster >>24);
 278   2                      gc_PlayRecordDataBuf[32] = (U8)(gdw_HostDIRFDB_StartCluster>>16);
 279   2                      gc_PlayRecordDataBuf[33] = (U8)(gdw_HostDIRFDB_StartCluster>>8);
 280   2                      gc_PlayRecordDataBuf[34] = (U8) gdw_HostDIRFDB_StartCluster;
 281   2                      gc_PlayRecordDataBuf[35] = (U8)(gw_HostDIRFileIndex >>8);
 282   2                      gc_PlayRecordDataBuf[36] = (U8) gw_HostDIRFileIndex;
 283   2                      gc_PlayRecordDataBuf[37] = (U8)(gw_HostDIRFileTotalNumber >>8);
 284   2                      gc_PlayRecordDataBuf[38] = (U8) gw_HostDIRFileTotalNumber;  //20090216 chiayen add
 285   2              }
 286   1              else    // Folder
 287   1              {
 288   2                      gc_PlayRecordDataBuf[5] = (U8)(gw_LogFileIndex >>8);//Nand
 289   2                      gc_PlayRecordDataBuf[6] = (U8) gw_LogFileIndex;//Nand           
 290   2                      gc_PlayRecordDataBuf[7] = (U8)(gw_SDLogFileIndex >>8);//SD
 291   2                      gc_PlayRecordDataBuf[8] = (U8) gw_SDLogFileIndex;//SD
 292   2                      gc_PlayRecordDataBuf[9] = (U8)(gw_USBLogFileIndex >>8);//USB
 293   2                      gc_PlayRecordDataBuf[10] = (U8)gw_USBLogFileIndex;//USB 
 294   2      
C51 COMPILER V7.10   LOGDATA                                                               02/28/2011 10:30:39 PAGE 6   

 295   2                      gc_PlayRecordDataBuf[11] = (U8)(gdw_DIRFDB_StartCluster >>24);  //20090216 chiayen add
 296   2                      gc_PlayRecordDataBuf[12] = (U8)(gdw_DIRFDB_StartCluster>>16);
 297   2                      gc_PlayRecordDataBuf[13] = (U8)(gdw_DIRFDB_StartCluster>>8);
 298   2                      gc_PlayRecordDataBuf[14] = (U8) gdw_DIRFDB_StartCluster;
 299   2      
 300   2                      gc_PlayRecordDataBuf[15] = (U8)(gw_DIRFileIndex >>8);
 301   2                      gc_PlayRecordDataBuf[16] = (U8) gw_DIRFileIndex ;
 302   2      
 303   2                      gc_PlayRecordDataBuf[18] = (U8)(gw_DIRFileTotalNumber >>8);
 304   2                      gc_PlayRecordDataBuf[19] = (U8) gw_DIRFileTotalNumber ;
 305   2                      gc_PlayRecordDataBuf[23] = (U8)(gdw_SDDIRFDB_StartCluster >>24);
 306   2                      gc_PlayRecordDataBuf[24] = (U8)(gdw_SDDIRFDB_StartCluster>>16);
 307   2                      gc_PlayRecordDataBuf[25] = (U8)(gdw_SDDIRFDB_StartCluster>>8);
 308   2                      gc_PlayRecordDataBuf[26] = (U8) gdw_SDDIRFDB_StartCluster;
 309   2                      gc_PlayRecordDataBuf[27] = (U8)(gw_SDDIRFileIndex >>8);
 310   2                      gc_PlayRecordDataBuf[28] = (U8) gw_SDDIRFileIndex;
 311   2                      gc_PlayRecordDataBuf[29] = (U8)(gw_SDDIRFileTotalNumber >>8);
 312   2                      gc_PlayRecordDataBuf[30] = (U8) gw_SDDIRFileTotalNumber;
 313   2      
 314   2                      gc_PlayRecordDataBuf[31] = (U8)(gdw_HostDIRFDB_StartCluster >>24);
 315   2                      gc_PlayRecordDataBuf[32] = (U8)(gdw_HostDIRFDB_StartCluster>>16);
 316   2                      gc_PlayRecordDataBuf[33] = (U8)(gdw_HostDIRFDB_StartCluster>>8);
 317   2                      gc_PlayRecordDataBuf[34] = (U8) gdw_HostDIRFDB_StartCluster;
 318   2                      gc_PlayRecordDataBuf[35] = (U8)(gw_HostDIRFileIndex >>8);
 319   2                      gc_PlayRecordDataBuf[36] = (U8) gw_HostDIRFileIndex;
 320   2                      gc_PlayRecordDataBuf[37] = (U8)(gw_HostDIRFileTotalNumber >>8);
 321   2                      gc_PlayRecordDataBuf[38] = (U8) gw_HostDIRFileTotalNumber;  //20090216 chiayen add
 322   2      
 323   2                      if(gc_CurrentCard==0)  //20090216 chiayen add
 324   2                      {
 325   3                              gc_PlayRecordDataBuf[11] = ((U8 *)(&gs_File_FCB[0].dw_FDB_StartCluster))[0];
 326   3                              gc_PlayRecordDataBuf[12] = ((U8 *)(&gs_File_FCB[0].dw_FDB_StartCluster))[1];
 327   3                              gc_PlayRecordDataBuf[13] = ((U8 *)(&gs_File_FCB[0].dw_FDB_StartCluster))[2];
 328   3                              gc_PlayRecordDataBuf[14] = ((U8 *)(&gs_File_FCB[0].dw_FDB_StartCluster))[3];
 329   3      
 330   3                              gc_PlayRecordDataBuf[15] = ((U8 *)(&gw_FileIndex[0]))[0];
 331   3                              gc_PlayRecordDataBuf[16] = ((U8 *)(&gw_FileIndex[0]))[1];
 332   3                      
 333   3                              gc_PlayRecordDataBuf[17] = gs_File_FCB[0].c_FileType;
 334   3                              gc_PlayRecordDataBuf[18] = ((U8 *)(&gw_FileTotalNumber[0]))[0];
 335   3                              gc_PlayRecordDataBuf[19] = ((U8 *)(&gw_FileTotalNumber[0]))[1]; 
 336   3                      }
 337   2                      else if(gc_CurrentCard==2)  //20090216 chiayen add
 338   2                      {
 339   3                              gc_PlayRecordDataBuf[23] = ((U8 *)(&gs_File_FCB[0].dw_FDB_StartCluster))[0];
 340   3                              gc_PlayRecordDataBuf[24] = ((U8 *)(&gs_File_FCB[0].dw_FDB_StartCluster))[1];
 341   3                              gc_PlayRecordDataBuf[25] = ((U8 *)(&gs_File_FCB[0].dw_FDB_StartCluster))[2];
 342   3                              gc_PlayRecordDataBuf[26] = ((U8 *)(&gs_File_FCB[0].dw_FDB_StartCluster))[3];
 343   3                              gc_PlayRecordDataBuf[27] = ((U8 *)(&gw_FileIndex[0]))[0];
 344   3                              gc_PlayRecordDataBuf[28] = ((U8 *)(&gw_FileIndex[0]))[1];
 345   3                              gc_PlayRecordDataBuf[29] = ((U8 *)(&gw_FileTotalNumber[0]))[0];
 346   3                              gc_PlayRecordDataBuf[30] = ((U8 *)(&gw_FileTotalNumber[0]))[1];         
 347   3                      }
 348   2                      else if(gc_CurrentCard==5)  //20090216 chiayen add
 349   2                      {
 350   3                              gc_PlayRecordDataBuf[31] = ((U8 *)(&gs_File_FCB[0].dw_FDB_StartCluster))[0];
 351   3                              gc_PlayRecordDataBuf[32] = ((U8 *)(&gs_File_FCB[0].dw_FDB_StartCluster))[1];
 352   3                              gc_PlayRecordDataBuf[33] = ((U8 *)(&gs_File_FCB[0].dw_FDB_StartCluster))[2];
 353   3                              gc_PlayRecordDataBuf[34] = ((U8 *)(&gs_File_FCB[0].dw_FDB_StartCluster))[3];
 354   3                              gc_PlayRecordDataBuf[35] = ((U8 *)(&gw_FileIndex[0]))[0];
 355   3                              gc_PlayRecordDataBuf[36] = ((U8 *)(&gw_FileIndex[0]))[1];
 356   3                              gc_PlayRecordDataBuf[37] = ((U8 *)(&gw_FileTotalNumber[0]))[0];
C51 COMPILER V7.10   LOGDATA                                                               02/28/2011 10:30:39 PAGE 7   

 357   3                              gc_PlayRecordDataBuf[38] = ((U8 *)(&gw_FileTotalNumber[0]))[1];                 
 358   3                      }       
 359   2              }
 360   1              gc_PlayRecordDataBuf[0] = gs_DSP_GLOBAL_RAM.sw_Volume;//Vol
 361   1              gc_PlayRecordDataBuf[1] = gs_DSP_GLOBAL_RAM.sc_EQ_Type;//EQ
 362   1              gc_PlayRecordDataBuf[2] = gc_RepPlayMode;
 363   1              gc_PlayRecordDataBuf[3] = (U8)(gw_FM_frequency >>8);
 364   1              gc_PlayRecordDataBuf[4] = (U8) gw_FM_frequency;
 365   1      
 366   1              gc_PlayRecordDataBuf[20] = gb_DirPlay_Flag;
 367   1              gc_PlayRecordDataBuf[22] = gc_LanguageSel;
 368   1              gc_PlayRecordDataBuf[39] = gc_Contrast;
 369   1              gc_PlayRecordDataBuf[40]=gc_ContrastSaveOrNot;
 370   1      }
 371          
 372          
 373          U8 USER_LogFile_ReadWrite(U8 tbt_ReadOrWrite)//use reserveblock for log
 374          {
 375   1              if(tbt_ReadOrWrite==0)//read log
 376   1              {
 377   2                      Read_LogData();
 378   2                      USER_GetSettingInfo();
 379   2              }
 380   1              else
 381   1              {
 382   2                      USER_FillSettingInfo();
 383   2                      Write_LogData();
 384   2              }
 385   1              return 0;
 386   1      }
 387          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1745    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----       1
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       3
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----       2
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
