C51 COMPILER V7.10   TFT_DISPLAYB7                                                         02/28/2011 10:30:57 PAGE 1   


C51 COMPILER V7.10, COMPILATION OF MODULE TFT_DISPLAYB7
OBJECT MODULE PLACED IN .\obj\TFT_displayB7.obj
COMPILER INVOKED BY: F:\Keil C 7.10\chengxu\C51\BIN\C51.EXE LCM\TFT_displayB7.c LARGE OPTIMIZE(9,SIZE) BROWSE NOAREGS IN
                    -CDIR(..\libsource\header) DEFINE(K_ICTYPE=0x03) DEBUG OBJECTEXTEND PRINT(.\lst\TFT_displayB7.lst) OBJECT(.\obj\TFT_displ
                    -ayB7.obj)

line level    source

   1          #include "SPDA2K.h"
   2          #include "..\LCM\LCM_func.h"
   3          #include "..\LCM\TFT_config.h"
   4          #include "..\LCM\TFT_display.h"
   5          #include "..\header\variables.h"
   6          
   7          extern  data    U8      gc_CurrentCard;
   8          extern  xdata   U8      gc_LanguageSel;
   9          extern  xdata   U8      gc_IconY;
  10          extern  xdata   U8      gc_IconType;
  11          extern  xdata   U16     gw_FileIndex[]; 
  12          extern  xdata   U16     gw_FileTotalNumber[];
  13          
  14          extern void LCD_DisplayIcon(U8 tw_IconIDNumber,U8 tc_CurrentOffset);
  15          
  16          extern  xdata   U8      gc_JPGSetting;
  17          extern  xdata   U8      gc_FuncPicCount;
  18          extern  xdata   U8      gc_MenuItem;
  19          
  20          #if 1
  21          // USB
  22          void TFT_ShowUSBIcon(void)
  23          {
  24   1              LCM_set_view(TFT_IconDispDir,0,0,TFT_H_Size,TFT_V_Size);
  25   1              LCD_DisplayIcon(ID_PUBLIC_FULL,OFFSET_USB);
  26   1      }
  27          #endif
  28          
  29          // 開機動畫
  30          void TFT_PowerOnlogo(void)
  31          {
  32   1              data    U16 i;
  33   1      
  34   1              LCM_set_view(TFT_IconDispDir,PowerONLogo_X_Pos,PowerONLogo_Y_Pos,PowerONLogo_H_Size,PowerONLogo_V_Size);
  35   1              for(i=0;i<PowerONLogoPicNum;i++)
  36   1              {
  37   2                      LCD_DisplayIcon(PowerONLogoID,i);
  38   2                      LCD_BACKLIGHT_ON;
  39   2                      USER_DelayDTms(PowerONLogoTimer);
  40   2              }
  41   1      }
  42          
  43          // 關機動畫
  44          void TFT_PowerOfflogo(void)
  45          {
  46   1              data    U8 i;
  47   1      
  48   1              LCM_set_view(TFT_IconDispDir,0,0,TFT_H_Size,TFT_V_Size);
  49   1      
  50   1              for(i=0;i<PowerOFFLogoPicNum;i++)
  51   1              {
  52   2                      LCD_DisplayIcon(PowerOFFLogoID,i);
  53   2                      USER_DelayDTms(80);
C51 COMPILER V7.10   TFT_DISPLAYB7                                                         02/28/2011 10:30:57 PAGE 2   

  54   2              }
  55   1              USER_DelayDTms(500);
  56   1      }
  57          
  58          // 功能選項-Music/Movie/Photo/Setup
  59          void TFT_ShowMenu(void)
  60          {
  61   1          U8 x_menu;
  62   1      
  63   1              LCM_set_view(TFT_IconDispDir,MainMenu_Title_X_Pos,MainMenu_Title_Y_Pos,MainMenu_Title_H_Size,MainMenu_Tit
             -le_V_Size);
  64   1              x_menu = gc_MenuItem+gc_LanguageSel*4;
  65   1              LCD_DisplayIcon(ID_MainMenu_Title,x_menu);
  66   1      
  67   1              LCM_set_view(TFT_IconDispDir,MainMenu_X_Pos,MainMenu_Y_Pos,MainMenu_H_Size,MainMenu_V_Size);
  68   1              x_menu = (gc_MenuItem*NumOfGroup+gc_FuncPicCount);//+gc_LanguageSel*16;
  69   1              LCD_DisplayIcon(ID_MainMenu,x_menu);
  70   1      
  71   1              gc_FuncPicCount++;
  72   1              if(gc_FuncPicCount==NumOfGroup)
  73   1              {
  74   2                      gc_FuncPicCount=0;
  75   2              }
  76   1      }
  77                  
  78          // JPG播放延遲時間
  79          void TFT_Velocity(void)
  80          {
  81   1              data    U8      i;
  82   1              data    U8      BCD[2];
  83   1      
  84   1              if(gc_JpegVelocity==10)
  85   1              {
  86   2                      BCD[0]=1;
  87   2                      BCD[1]=0;
  88   2              }
  89   1              else
  90   1              {
  91   2                      BCD[0]=0;
  92   2                      BCD[1]=gc_JpegVelocity;
  93   2              }
  94   1      
  95   1              for(i=0;i<2;i++)
  96   1              {
  97   2                      LCM_set_view(TFT_IconDispDir,Velocity_X_Pos+(Velocity_H_Size+2)*i,Velocity_Y_Pos,Velocity_H_Size,Velocit
             -y_V_Size);
  98   2                      LCD_DisplayIcon(VelocityID,BCD[i]);
  99   2              }
 100   1      }
 101          
 102          
 103          U8 CheckNum(U16 num)
 104          {
 105   1              if(num>9999)    
 106   1              {
 107   2                      return 0;
 108   2              }
 109   1              if(num>999)             
 110   1              {
 111   2                      return 1;
 112   2              }
 113   1              if(num>99)      
C51 COMPILER V7.10   TFT_DISPLAYB7                                                         02/28/2011 10:30:57 PAGE 3   

 114   1              {
 115   2                      return 2;
 116   2              }
 117   1              if(num>9)
 118   1              {
 119   2                      return 3;
 120   2              }
 121   1              return 4;
 122   1      }
 123          // 記憶體資料
 124          void TFT_MemoryInfo(void)
 125          {
 126   1              data    U8      i,j;
 127   1              xdata   U8      BCD[15];
 128   1              data    U16     tc_used=gdw_CARD_TotalSizeMB-gdw_Dos_FreeMemorySizeMB;
 129   1      
 130   1              LCM_set_view(TFT_IconDispDir,0,0,TFT_H_Size,TFT_V_Size);
 131   1              //LCD_DisplayIcon(MemInfoID,0/*gc_LanguageSel*/);
 132   1              LCD_DisplayIcon(ID_PUBLIC_FULL,OFFSET_MemoryInfo_BG);
 133   1      
 134   1      //      if(gc_LanguageSel!=16)
 135   1              {
 136   2                      for(i=0;i<3;i++)
 137   2                      {
 138   3                              if(i==0)
 139   3                              {
 140   4                                      TFT_HEX_BCD_5(gdw_CARD_TotalSizeMB,BCD+0,BCD+1,BCD+2,BCD+3,BCD+4);
 141   4                                      j=CheckNum(gdw_CARD_TotalSizeMB);
 142   4                              }
 143   3                              else if(i==1)
 144   3                              {
 145   4                                      TFT_HEX_BCD_5(tc_used,BCD+5,BCD+6,BCD+7,BCD+8,BCD+9);
 146   4                                      j=CheckNum(tc_used);
 147   4                              }
 148   3                              else
 149   3                              {
 150   4                                      TFT_HEX_BCD_5(gdw_Dos_FreeMemorySizeMB,BCD+10,BCD+11,BCD+12,BCD+13,BCD+14);
 151   4                                      j=CheckNum(gdw_Dos_FreeMemorySizeMB);
 152   4                              }
 153   3                              
 154   3                              for(;j<5;j++)
 155   3                              {
 156   4      #ifdef  TFT_18_V
                                              LCM_set_view(TFT_IconDispDir,MemInfoNUM_X_Pos+j*MemInfoNUM_H_Size,MemInfoNUM_Y_Pos+i*22,MemInfoNUM_H_S
             -ize,MemInfoNUM_V_Size);
              #else
 159   4                                      LCM_set_view(TFT_IconDispDir,MemInfoNUM_X_Pos+j*MemInfoNUM_H_Size,MemInfoNUM_Y_Pos+i*17,MemInfo
             -NUM_H_Size,MemInfoNUM_V_Size);
 160   4      #endif
 161   4                                      LCD_DisplayIcon(MemInfoNumID,BCD[i*5+j]);
 162   4                              }
 163   3                      }
 164   2              }
 165   1      }
 166          
 167          void TFT_HEX_BCD_5(U16 num,U8 *AA,U8 *BB,U8 *CC,U8 *DD,U8 *EE)
 168          {
 169   1              *AA=num/10000;
 170   1              *BB=(num%10000)/1000;
 171   1              *CC=(num%1000)/100;
 172   1              *DD=(num%100)/10;
 173   1              *EE=num%10;
C51 COMPILER V7.10   TFT_DISPLAYB7                                                         02/28/2011 10:30:57 PAGE 4   

 174   1      }
 175          
 176          // 儲存裝置:NAND(0)/U-Disk(1)/SDC(2)
 177          void TFT_ShowMediaIcon_M(void)
 178          {
 179   1              data    U8      i;
 180   1      
 181   1              if(gc_CurrentCard==5)
 182   1              {
 183   2                      i=4;    // Host
 184   2              }
 185   1              else
 186   1              {
 187   2                      i=gc_CurrentCard;
 188   2              }
 189   1      
 190   1              LCM_set_view(TFT_IconDispDir,MediaIcon_X_Pos,MediaIcon_Y_Pos,MediaIcon_H_Size,MediaIcon_V_Size);
 191   1              LCD_DisplayIcon(MediaIconID,i);
 192   1      }
 193          
 194          // PAUSE 
 195          void TFT_PAUSE(void)
 196          {
 197   1              LCM_set_view(TFT_IconDispDir,Pause_X_Pos,Pause_Y_Pos,Pause_H_Size,Pause_V_Size);
 198   1              LCD_DisplayIcon(PauseID,0);
 199   1      }
 200          
 201          
 202          // 文件格式Icon
 203          void TFT_FileIcon(void)
 204          {
 205   1              LCM_set_view(TFT_IconDispDir,FileIcon_X_Pos,FileIcon_Y_Pos+20*gc_IconY,FileIcon_H_Size,FileIcon_V_Size);
 206   1              LCD_DisplayIcon(FileIconID,gc_IconType);
 207   1      }
 208          
 209          
 210          
 211           void Folder_Display()
 212          {
 213   1      //      U8 testbuf[]={16,0,'V',0,'1',0,'.',0,'0',0,'1',0,'.',0,'0',0,'1'};
 214   1              U8 i;
 215   1              U8      BCD[4];
 216   1              //扢离晊奀奀潔
 217   1      //      gc_FolderTimer=5;
 218   1              //珆尨掖劓
 219   1              LCM_set_view(TFT_IconDispDir,0,0,TFT_H_Size,TFT_V_Size);
 220   1              LCD_DisplayIcon(ID_PUBLIC_FULL,OFFSET_Floder_BG);   
 221   1              //刲坰狟珨跺恅璃標
 222   1      
 223   1              //珆尨絞ヶ⑻醴
 224   1      //      HEX_to_BCD(gw_FileIndex[gs_System_State.c_FileHandle],BCD+0,4);
 225   1              TFT_HEX_BCD(gw_FileIndex[0],(BCD+0),(BCD+1),(BCD+2),(BCD+3));
 226   1      
 227   1              for(i=0;i<4;i++)
 228   1              {
 229   2                      LCM_set_view(TFT_IconDispDir,30+FMAdj_H_Size*i,50,FMAdj_H_Size,FMAdj_V_Size);
 230   2                      LCD_DisplayIcon(FMAdjID,BCD[i]);        
 231   2              } 
 232   1              //珆尨軞⑻醴
 233   1      //      HEX_to_BCD(gw_FileTotalNumber[gs_System_State.c_FileHandle],BCD+0,4);
 234   1              TFT_HEX_BCD(gw_FileTotalNumber[0],(BCD+0),(BCD+1),(BCD+2),(BCD+3));
 235   1      
C51 COMPILER V7.10   TFT_DISPLAYB7                                                         02/28/2011 10:30:57 PAGE 5   

 236   1              for(i=0;i<4;i++)
 237   1              {
 238   2                      LCM_set_view(TFT_IconDispDir,85+FMAdj_H_Size*i,50,FMAdj_H_Size,FMAdj_V_Size);
 239   2                      LCD_DisplayIcon(FMAdjID,BCD[i]);        
 240   2              }
 241   1              //珆尨恅璃標靡備
 242   1       //     Menu_Disp_String(5,5,testbuf,0xffff,0); 
 243   1      //      Menu_Disp_String(Voice_Item_X,Voice_Item_Y,testbuf,Voice_Item_WordColor,Voice_Item_WordColor_BG);
 244   1      //    gs_str_scroll_state.c_str_1st_char=0;  //20090331
 245   1      //    gs_str_scroll_state.c_shift_in_1st_char=0;
 246   1              //LCD_Disp_FileName(&gc_FileLongName[5], gc_FileLongName[2], gc_FileLongName[4], 1);
 247   1      
 248   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1089    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----      37
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      11
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
